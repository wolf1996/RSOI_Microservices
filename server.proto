syntax  = "proto3";


package token;

import public "token.proto";

message Empty{};

message AccessTokenMsg{
    string tokenString = 1;
}

message RefreshTokenMsg{
    string tokenString = 1;
}

message CodeflowTokenMsg{
    string tokenString = 1;
}


message Tokenpair{
    AccessTokenMsg accessToken = 1;
    RefreshTokenMsg refreshToken = 2;
}

message SignInPair{
    string login = 1;
    string pass  = 2;
}

message ValidResult{
    bool valid = 1;
    Token tok  = 2;
}

message ClientInfo{
    int64 Id        = 1;
    string Name     = 2;
    string Redirurl = 3;
}

message ClientId{
    int64 Id = 1;
}

service AuthService {
    rpc GetAccessToken(RefreshTokenMsg) returns (Tokenpair){};
    rpc GetTokenpair(SignInPair) returns (Tokenpair){};
    rpc AccessTokenValidation(AccessTokenMsg) returns (ValidResult) {};
    rpc GetCodeFlow(Token) returns (CodeflowTokenMsg){};
    rpc ShiftCodeFlow(CodeflowTokenMsg) returns (Tokenpair){};
    rpc GetClientInfo(ClientId) returns (ClientInfo){};
}

